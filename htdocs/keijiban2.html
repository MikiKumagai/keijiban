<!DOCTYPE html>
<html>

<head>
    <title>
        掲示板
    </title>
</head>

<body>

    <?php

    try {
        $pdo = new PDO(
            'mysql:host=localhost;dbname=ranking;','kmmk','uwfyzcyr',
            [PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC]
        );
    
        $stmt = $pdo->prepare('SELECT * FROM bbs WHERE thread_id=? ORDER BY date DESC');
        $stmt->execute(array($_REQUEST['thread_id']));
        $row_count = $stmt->rowCount();

        foreach ($stmt as $hyouji) {
            echo $row_count, ' ';
            $row_count -= 1;
            echo $hyouji['name'];
            echo '<br>';
            echo nl2br($hyouji['contents']);
            echo '<br>';
            echo '<p style="text-align:right">';
            echo $hyouji['date'];
            echo '</p>';
            echo '<hr>';
        }
    
    } catch (PDOException $e) {
        echo $e->getMessage();
    
    } finally {
        $pdo = null;
    }

?>
</body>